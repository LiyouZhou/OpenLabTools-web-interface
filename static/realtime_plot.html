
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Flot Examples: AJAX</title>
	<link href="./flot/examples/examples.css" rel="stylesheet" type="text/css">
	<!--[if lte IE 8]><script language="javascript" type="text/javascript" src="./flot/excanvas.min.js"></script><![endif]-->
	<script language="javascript" type="text/javascript" src="./flot/jquery.js"></script>
	<script language="javascript" type="text/javascript" src="./flot/jquery.flot.js"></script>
    <script language="javascript" type="text/javascript" src="./flot/jquery.flot.time.js"></script>
	<script type="text/javascript">
	
		var options = {
			lines:  { show: true },
			points: { show: true },
			xaxis:  { mode: "time" }
		};
		
		var data = [];
		//$.plot("#placeholder", data, options);
		var iteration = 0;

		function fetchData() {
			++iteration;
			function onDataReceived(series) {
				data.push( [series.time*1000, series.data] );
                if (iteration > 10) { data.shift() }
                console.log(data)
				$.plot("#placeholder", [{ lable: "first serise", data: data }], options);
			}
			$.ajax({
				url: "/get_new_point",
				type: "GET",
				dataType: "json",
				success: onDataReceived
			});
			setTimeout(fetchData, 2000);
		}
		fetchData();
	</script>
</head>
<body>
	<div id="header">
		<h2>AJAX</h2>
	</div>
	<div id="content">
		<div class="demo-container">
			<div id="placeholder" class="demo-placeholder"></div>
		</div>
		<p>If you combine AJAX with setTimeout, you can poll the server for new data.</p>
		<p>
			<button class="dataUpdate">Poll for data</button>
		</p>

	</div>
</body>
</html>
